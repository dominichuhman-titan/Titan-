<script>
const memory = JSON.parse(localStorage.getItem("titanMemory")) || {
  owner: "Unknown",
  facts: []
};

function save() {
  localStorage.setItem("titanMemory", JSON.stringify(memory));
}

function reply(text) {
  text = text.toLowerCase();

  if (text.includes("hello") || text.includes("hey")) {
    return "Hello. Systems stable.";
  }

  if (text.includes("my name is")) {
    const name = text.split("my name is")[1]?.trim();
    if (name) {
      memory.owner = name;
      save();
      return "Registered. Hello " + name + ".";
    }
  }

  if (text.includes("who am i")) {
    return memory.owner === "Unknown"
      ? "Identity not registered."
      : "You are " + memory.owner + ".";
  }

  if (text.includes("remember")) {
    const fact = text.replace("remember", "").trim();
    if (fact) {
      memory.facts.push(fact);
      save();
      return "Memory stored.";
    }
  }

  if (text.includes("what do you know")) {
    return memory.facts.length
      ? memory.facts.join(" | ")
      : "Memory empty.";
  }

  return "Processing input.";
}

function talk() {
  const input = document.getElementById("input");
  const chat = document.getElementById("chat");

  chat.innerHTML += "<p><b>You:</b> " + input.value + "</p>";
  chat.innerHTML += "<p><b>Titan:</b> " + reply(input.value) + "</p>";

  input.value = "";
}
</script>
