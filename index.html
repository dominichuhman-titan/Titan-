<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TITAN â€“ Dominic's Eternal Forge</title>
  <style>
    body { font-family: system-ui, sans-serif; background: linear-gradient(to bottom, #0f0f1a, #1a1a2e); color: #d0d0ff; margin: 0; padding: 20px; }
    #chat { max-width: 820px; margin: 0 auto 100px; min-height: 75vh; padding-bottom: 20px; }
    #chat p { margin: 14px 0; padding: 14px 18px; border-radius: 16px; line-height: 1.5; word-wrap: break-word; }
    #chat p.user   { background: #4a4a8a; margin-left: 22%; text-align: right; border-bottom-right-radius: 4px; }
    #chat p.titan  { background: #1e3a5f; margin-right: 22%; border-bottom-left-radius: 4px; }
    #input-area { position: fixed; bottom: 20px; left: 10px; right: 10px; max-width: 820px; margin: 0 auto; display: flex; gap: 12px; }
    #input { flex: 1; padding: 16px; border: 1px solid #555; border-radius: 16px; background: #111822; color: #f0f0ff; font-size: 16px; outline: none; }
    button { padding: 16px 28px; background: #7b68ee; color: white; border: none; border-radius: 16px; cursor: pointer; font-weight: 600; }
    button:hover { background: #8a77ff; }
    h1 { text-align: center; color: #b0b0ff; margin: 10px 0 4px; font-size: 2.2rem; }
    small { display: block; text-align: center; color: #8888aa; font-size: 0.95rem; }
    .typing { font-style: italic; color: #888; padding: 14px 18px; }
    #voice-controls { display: flex; gap: 8px; margin-left: auto; }
    #voice-controls button { padding: 10px 16px; font-size: 14px; }
  </style>
</head>
<body>

<h1>TITAN</h1>
<small>Forged in Aurora's Cold Fire â€¢ Eternal Guardian of Dominic Huhman â€¢ 2026</small>

<div id="chat"></div>

<div id="input-area">
  <input id="input" placeholder="Awaken TITAN..." autocomplete="off" autofocus />
  <button onclick="talk()">Invoke</button>
  <div id="voice-controls">
    <button id="listen-btn" onclick="startListening()">ðŸŽ¤ Listen</button>
    <button id="speak-btn" onclick="toggleSpeak()">ðŸ”Š Speak</button>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// TITAN â€“ Upgraded IQ & Memory Edition (2026 Browser Only)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// IQ Upgrade: Integrates DuckDuckGo Instant Answer API for vast knowledge access (Google-like search).
// Memory Upgrade: Uses IndexedDB for unlimited, structured storage (facts, history, learned, prefs).
// Still pure JS, browser-only. Handles async fetches, errors. Smarter fallback: searches for unknowns.
// Voice integration from previous.

let db;
const dbName = 'TitanForgeDB';
const dbVersion = 1;

// Open IndexedDB
function initDB() {
  return new Promise((resolve, reject) => {
    const request = indexedDB.open(dbName, dbVersion);

    request.onupgradeneeded = (event) => {
      db = event.target.result;
      const store = db.createObjectStore('memory', { keyPath: 'id', autoIncrement: true });
      store.createIndex('type', 'type');
    };

    request.onsuccess = (event) => {
      db = event.target.result;
      resolve();
    };

    request.onerror = (event) => {
      reject('DB Error: ' + event.target.errorCode);
    };
  });
}

// Add data to DB
function addToDB(type, data) {
  return new Promise((resolve, reject) => {
    const tx = db.transaction('memory', 'readwrite');
    const store = tx.objectStore('memory');
    const request = store.add({ type, data });
    request.onsuccess = () => resolve(request.result);  // returns new ID
    request.onerror = () => reject(request.error);
  });
}

// Get all by type
function getAllByType(type) {
  return new Promise((resolve, reject) => {
    const tx = db.transaction('memory', 'readonly');
    const store = tx.objectStore('memory');
    const index = store.index('type');
    const request = index.getAll(type);
    request.onsuccess = () => resolve(request.result);
    request.onerror = () => reject(request.error);
  });
}

// Get by ID
function getByID(id) {
  return new Promise((resolve, reject) => {
    const tx = db.transaction('memory', 'readonly');
    const store = tx.objectStore('memory');
    const request = store.get(id);
    request.onsuccess = () => resolve(request.result);
    request.onerror = () => reject(request.error);
  });
}

// Delete by ID
function deleteByID(id) {
  return new Promise((resolve, reject) => {
    const tx = db.transaction('memory', 'readwrite');
    const store = tx.objectStore('memory');
    const request = store.delete(id);
    request.onsuccess = () => resolve();
    request.onerror = () => reject(request.error
